/* Theme Colors - Using Radix UI Color System
 * Sand: Base color for all elements
 * Red/Green/Blue: Reserved for special boxes (TBD)
 * Sources:
 * - Sand: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/sand.css
 * - Red: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/red.css
 * - Blue: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/blue.css
 * - Green: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/green.css
 * - Dark variants: 
 *   - Sand: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/sand-dark.css
 *   - Red: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/red-dark.css
 *   - Blue: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/blue-dark.css
 *   - Green: https://cdn.jsdelivr.net/npm/@radix-ui/colors@latest/green-dark.css
 * 
 * COLOR USAGE GUIDELINES:
 * 1. ALL color definitions MUST be in this section only
 * 2. NEVER add new color definitions anywhere else in this file
 *    - ONLY use colors from the Radix color system defined above
 *    - NEVER add custom colors
 * 3. Colors are organized in two root blocks:
 *    - [data-theme="light"] for light mode colors
 *    - [data-theme="dark"] for dark mode colors
 * 4. Each block contains:
 *    - Base colors (Sand palette)
 *    - Accent colors (Red, Blue, Green)
 */

/* Base theme styles */
:root {
    /* Base colors that don't change with theme */
    --side-nav-width: min(350px, 90vw);
    --content-max-width: 65ch;
    --spacing-xs: 0.25rem;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;
    --spacing-xxl: 3rem;

    /* Typography */
    --font-serif: "Source Serif 4", Georgia, "Times New Roman", serif;
    --font-sans: "Source Sans 3", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    --font-size-base: 1rem;
    --line-height-base: 1.5;
    --line-height-heading: 1.2;
}

/* Light theme colors */
:root[data-theme="light"] {
    /* Theme colors */
    --background-color: var(--sand-2);
    --text-color: var(--sand-12);
    --divider-color: var(--sand-6);

    /* Base colors (Sand) */
    --sand-1: #fdfdfc;
    /* Backgrounds */
    --sand-2: #f9f9f8;
    /* Backgrounds */
    --sand-3: #f1f0ef;
    /* Interactive Components */
    --sand-4: #e9e8e6;
    /* Interactive Components */
    --sand-5: #e2e1de;
    /* Interactive Components */
    --sand-6: #dad9d6;
    /* Borders and separators */
    --sand-7: #cfceca;
    /* Borders and separators */
    --sand-8: #bcbbb5;
    /* Borders and separators */
    --sand-9: #8d8d86;
    /* Solid colors */
    --sand-10: #82827c;
    /* Solid colors */
    --sand-11: #63635e;
    /* Accessible text */
    --sand-12: #21201c;
    /* Accessible text */

    /* Disclaimer box */
    --red-9: #e5484d;
    /* Primary accent */
    --red-10: #dc3e42;
    /* Hover state */
    --red-11: #ce2c31;
    /* Active state */
    --red-12: #641723;
    /* Accessible text */

    /* Explanatory box */
    --blue-9: #0090ff;
    /* Primary accent */
    --blue-10: #0588f0;
    /* Hover state */
    --blue-11: #0d74ce;
    /* Active state */
    --blue-12: #113264;
    /* Accessible text */

    /* Legal box */
    --green-9: #30a46c;
    /* Primary accent */
    --green-10: #2b9a66;
    /* Hover state */
    --green-11: #218358;
    /* Active state */
    --green-12: #193b2d;
    /* Accessible text */
}

/* Dark theme colors */
:root[data-theme="dark"] {
    /* Theme colors */
    --background-color: var(--sand-2);
    --text-color: var(--sand-12);
    --divider-color: var(--sand-6);

    /* Base colors (Sand) */
    --sand-1: #111110;
    /* Backgrounds */
    --sand-2: #191918;
    /* Backgrounds */
    --sand-3: #222221;
    /* Interactive Components */
    --sand-4: #2a2a28;
    /* Interactive Components */
    --sand-5: #31312e;
    /* Interactive Components */
    --sand-6: #3b3a37;
    /* Borders and separators */
    --sand-7: #494844;
    /* Borders and separators */
    --sand-8: #62605b;
    /* Borders and separators */
    --sand-9: #6f6d66;
    /* Solid colors */
    --sand-10: #7c7b74;
    /* Solid colors */
    --sand-11: #b5b3ad;
    /* Accessible text */
    --sand-12: #eeeeec;
    /* Accessible text */

    /* Disclaimer box */
    --red-9: #e5484d;
    /* Primary accent */
    --red-10: #ec5d5e;
    /* Hover state */
    --red-11: #ff9592;
    /* Active state */
    --red-12: #ffd1d9;
    /* Accessible text */

    /* Explanatory box */
    --blue-9: #0090ff;
    /* Primary accent */
    --blue-10: #3b9eff;
    /* Hover state */
    --blue-11: #70b8ff;
    /* Active state */
    --blue-12: #c2e6ff;
    /* Accessible text */

    /* Legal box */
    --green-9: #30a46c;
    /* Primary accent */
    --green-10: #33b074;
    /* Hover state */
    --green-11: #3dd68c;
    /* Active state */
    --green-12: #b1f1cb;
    /* Accessible text */
}

/* Apply theme colors */
body {
    background-color: var(--background-color);
    color: var(--text-color);
    min-height: 100vh;
    line-height: var(--line-height-base);
    font-family: var(--font-serif);
    font-size: var(--font-size-base);
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.side-nav {
    background-color: var(--background-color);
    border-left: 1px solid var(--divider-color);
    border-right: 1px solid var(--divider-color);
    width: 100%;
    max-width: var(--side-nav-width);
    position: fixed;
    top: 0;
    right: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    z-index: 1000;
}

/* Theme selector styles */
.theme-select-wrapper {
    position: relative;
    display: inline-flex;
    align-items: center;
    width: 100%;
}

.theme-select-wrapper select {
    width: 100%;
    padding: var(--spacing-xs) var(--spacing-sm);
    padding-right: var(--spacing-xl);
    border: 1px solid var(--divider-color);
    border-radius: 4px;
    background: var(--background-color);
    color: var(--text-color);
    appearance: none;
    cursor: pointer;
}

.theme-icon {
    position: absolute;
    right: var(--spacing-sm);
    top: 50%;
    transform: translateY(-50%);
    width: 1.2em;
    height: 1.2em;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s ease;
    color: var(--text-color);
}

/* Show icon based on selected value */
#theme-select[value="system"]~.system-icon,
#theme-select[value="light"]~.light-icon,
#theme-select[value="dark"]~.dark-icon {
    opacity: 1;
}

/* Theme control styles */
.theme-icon {
    display: none;
}

[data-theme="light"] .light-icon {
    display: block;
}

[data-theme="dark"] .dark-icon {
    display: block;
}

/* Keyboard shortcuts */
.keyboard-shortcuts {
    display: grid;
    grid-template-columns: repeat(2, auto);
    gap: var(--spacing-xs);
    padding: var(--spacing-sm) 0;
    justify-content: start;
}

.shortcut-btn {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-sm);
    border: none;
    background: none;
    color: var(--text-color);
    font-size: 0.9em;
    text-align: left;
    cursor: pointer;
    white-space: nowrap;
}

.shortcut-btn:hover {
    color: var(--sand-11);
}

.shortcut-btn kbd {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 1.6em;
    height: 1.6em;
    background-color: var(--sand-3);
    border: 1px solid var(--divider-color);
    border-radius: 3px;
    padding: 0 0.4em;
    font-size: 0.8em;
    font-family: var(--font-sans);
    line-height: 1;
}

/* Font Usage Rules
 * 1. Default font is serif (--font-serif) for all text content
 * 2. Sans-serif (--font-sans) is used ONLY in:
 *    - Navigation elements (.side-nav)
 *    - Special boxes:
 *      - Legal boxes (.legal-box)
 *      - Explanatory boxes (.explanatory-box)
 *      - Disclaimer boxes (.disclaimer-box)
 *      - KPI boxes (.kpi-box)
 *      - Glossary elements (.glossary)
 *      - Recital elements (.recital-box)
 */

/* Modern CSS Reset */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 100%;
    text-size-adjust: none;
    -webkit-text-size-adjust: none;
}

/* Typography */

/* UI Elements - Sans-serif */
.side-nav *,
.legal-box *,
.explanatory-box *,
.disclaimer-box * {
    font-family: var(--font-sans);
}

h1 {
    font-size: 2.5rem;
    margin-bottom: var(--spacing-xl);
    margin-top: var(--spacing-xl);
    width: 100%;
    max-width: var(--content-max-width);
}

h1,
h2,
h3,
h4,
h5 {
    font-family: var(--font-serif);
    line-height: var(--line-height-heading);
    color: inherit;
}

p {
    margin-bottom: 1rem;
    line-height: var(--line-height-base);
    max-width: var(--content-max-width);
}

a {
    color: inherit;
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 0.2em;
    transition: color 0.2s ease;
}

a:hover {
    color: var(--sand-11);
}

strong {
    font-weight: 600;
}

/* Lists */
ul,
ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
    max-width: var(--content-max-width);
}

li {
    margin-bottom: 0.5rem;
    line-height: var(--line-height-base);
}

dl {
    margin-bottom: 1rem;
    max-width: var(--content-max-width);
}

dt {
    font-weight: 600;
    margin-top: 1rem;
}

dd {
    margin-left: 0;
    margin-top: 0.5rem;
}

/* Dark mode link colors */
@media (prefers-color-scheme: dark) {
    a:hover {
        color: var(--sand-11);
    }
}

body.light-mode a:hover {
    color: var(--sand-11);
}

body.dark-mode a:hover {
    color: var(--sand-11);
}

/* Images and Media */
img,
picture,
video,
canvas,
svg {
    display: block;
    max-width: 100%;
}

/* Forms and Inputs */
input,
button,
textarea,
select {
    font: inherit;
}

/* Layout Base */
.main-content {
    width: 100%;
    max-width: var(--content-max-width);
    margin-inline: auto;
    padding-inline: var(--spacing-md);
}

/* Content Boxes */
/* Base styles for all boxes */
.disclaimer-box,
.explanatory-box,
.legal-box {
    width: 100%;
    max-width: var(--content-max-width);
    margin-bottom: var(--spacing-lg);
    border-radius: 4px;
    overflow: hidden;
    font-family: var(--font-sans);
}

/* Box headers */
.disclaimer-box h4,
.explanatory-box h4,
.legal-box h4,
.kpi-box h4 {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-md);
    font-family: var(--font-sans);
    font-weight: 600;
    font-size: 1.1rem;
    line-height: 1;
    margin: 0;
    position: relative;
    cursor: pointer;
    user-select: none;
}

/* Add icons before headers */
.disclaimer-box h4::before,
.explanatory-box h4::before,
.legal-box h4::before,
.kpi-box h4::before {
    content: "";
    display: block;
    width: 1.1rem;
    height: 1.1rem;
    flex-shrink: 0;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
}

/* Add chevron after headers - base styles */
.disclaimer-box h4::after,
.explanatory-box h4::after,
.legal-box h4::after,
.kpi-box h4::after {
    content: '';
    position: absolute;
    right: var(--spacing-md);
    width: 1.1rem;
    height: 1.1rem;
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.7;
    transition: transform 0.3s ease;
}

/* Box-specific chevron colors */
.legal-box h4::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2330a46c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
}

.explanatory-box h4::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%230090ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
}

.disclaimer-box h4::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23e5484d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
}

/* Dark theme chevron colors */
:root[data-theme="dark"] .legal-box h4::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%233dd68c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
}

:root[data-theme="dark"] .explanatory-box h4::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2370b8ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
}

:root[data-theme="dark"] .disclaimer-box h4::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ff9592' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
}

/* Box content spacing */
/* Reset padding for direct children */
.disclaimer-box>*:not(h4),
.explanatory-box>*:not(h4),
.legal-box>*:not(h4),
.kpi-box>*:not(h4) {
    padding: 0 var(--spacing-md);
}

/* First element after header gets top margin */
.disclaimer-box>*:not(h4):first-of-type,
.explanatory-box>*:not(h4):first-of-type,
.legal-box>*:not(h4):first-of-type,
.kpi-box>*:not(h4):first-of-type {
    margin-top: var(--spacing-md);
}

/* Last element gets bottom margin */
.disclaimer-box>*:not(h4):last-child,
.explanatory-box>*:not(h4):last-child,
.legal-box>*:not(h4):last-child,
.kpi-box>*:not(h4):last-child {
    margin-bottom: var(--spacing-md);
}

/* Lists inside boxes */
.disclaimer-box ul,
.disclaimer-box ol,
.explanatory-box ul,
.explanatory-box ol,
.legal-box ul,
.legal-box ol,
.kpi-box ul,
.kpi-box ol {
    padding-left: calc(var(--spacing-md) + 1.5rem);
    padding-right: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

/* Nested lists */
.disclaimer-box ul ul,
.disclaimer-box ul ol,
.disclaimer-box ol ul,
.disclaimer-box ol ol,
.explanatory-box ul ul,
.explanatory-box ul ol,
.explanatory-box ol ul,
.explanatory-box ol ol,
.legal-box ul ul,
.legal-box ul ol,
.legal-box ol ul,
.legal-box ol ol,
.kpi-box ul ul,
.kpi-box ul ol,
.kpi-box ol ul,
.kpi-box ol ol {
    padding-left: 1.5rem;
    margin-top: var(--spacing-xs);
    margin-bottom: var(--spacing-xs);
}

/* List items */
.disclaimer-box li,
.explanatory-box li,
.legal-box li,
.kpi-box li {
    margin-bottom: var(--spacing-xs);
}

/* Last item in list */
.disclaimer-box li:last-child,
.explanatory-box li:last-child,
.legal-box li:last-child,
.kpi-box li:last-child {
    margin-bottom: 0;
}

/* Paragraphs inside boxes */
.disclaimer-box p,
.explanatory-box p,
.legal-box p,
.kpi-box p {
    margin-bottom: var(--spacing-md);
}

/* Legal Box */
.legal-box {
    background-color: color-mix(in srgb, var(--green-9) 10%, transparent);
    border: 1px solid color-mix(in srgb, var(--green-9) 20%, transparent);
}

.legal-box h4 {
    color: var(--green-12);
    background-color: color-mix(in srgb, var(--green-9) 15%, transparent);
}

.legal-box h4::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2330a46c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z'/%3E%3Cpath d='m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z'/%3E%3Cpath d='M7 21h10'/%3E%3Cpath d='M12 3v18'/%3E%3Cpath d='M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2'/%3E%3C/svg%3E");
}

/* Explanatory Box */
.explanatory-box {
    background-color: color-mix(in srgb, var(--blue-9) 10%, transparent);
    border: 1px solid color-mix(in srgb, var(--blue-9) 20%, transparent);
}

.explanatory-box h4 {
    color: var(--blue-12);
    background-color: color-mix(in srgb, var(--blue-9) 15%, transparent);
}

.explanatory-box h4::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%230090ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 16v-4'/%3E%3Cpath d='M12 8h.01'/%3E%3C/svg%3E");
}

/* Disclaimer Box */
.disclaimer-box {
    background-color: color-mix(in srgb, var(--red-9) 10%, transparent);
    border: 1px solid color-mix(in srgb, var(--red-9) 20%, transparent);
}

.disclaimer-box h4 {
    color: var(--red-12);
    background-color: color-mix(in srgb, var(--red-9) 15%, transparent);
}

.disclaimer-box h4::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23e5484d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z'/%3E%3Cpath d='M12 9v4'/%3E%3Cpath d='M12 17h.01'/%3E%3C/svg%3E");
}

/* Box content transition */
.disclaimer-box>*:not(h4),
.explanatory-box>*:not(h4),
.legal-box>*:not(h4),
.kpi-box>*:not(h4) {
    transition: max-height 0.3s ease-out;
}

/* Collapsed state */
.disclaimer-box.collapsed>*:not(h4),
.explanatory-box.collapsed>*:not(h4),
.legal-box.collapsed>*:not(h4),
.kpi-box.collapsed>*:not(h4) {
    display: none;
}

/* Rotate arrow when collapsed */
.disclaimer-box.collapsed h4::after,
.explanatory-box.collapsed h4::after,
.legal-box.collapsed h4::after,
.kpi-box.collapsed h4::after {
    transform: rotate(-90deg);
}

/* Arrow transition */
.disclaimer-box h4::after,
.explanatory-box h4::after,
.legal-box h4::after,
.kpi-box h4::after {
    transition: transform 0.3s ease;
}

/* Navigation Components */
/* Navigation Header */
.nav-header {
    padding: var(--spacing-md);
    border-bottom: 1px solid var(--sand-6);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.nav-header .box-icon {
    color: var(--sand-11);
}

/* Navigation Content */
.nav-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-md);
}

.nav-content ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.nav-content li {
    margin: var(--spacing-xs) 0;
}

.nav-content a {
    display: block;
    padding: var(--spacing-xs) 0;
    color: inherit;
    text-decoration: none;
    transition: color 0.2s ease;
}

.nav-content a:hover {
    color: var(--sand-11);
}

.nav-content a.active {
    font-weight: 600;
}

/* Navigation Footer */
.nav-footer {
    padding: var(--spacing-md);
    border-top: 1px solid var(--sand-6);
}

/* Navigation Toggle Button */
.nav-toggle {
    position: fixed;
    top: var(--spacing-md);
    right: var(--spacing-md);
    width: 2.5rem;
    height: 2.5rem;
    border: none;
    border-radius: 50%;
    background: var(--sand-1);
    color: inherit;
    cursor: pointer;
    z-index: 1001;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.nav-toggle:hover {
    transform: scale(1.05);
}

.nav-toggle i {
    width: 1.5rem;
    height: 1.5rem;
    color: var(--sand-11);
}

/* Breakpoints are set in stone. NEVER add any other breakpoints in this file. */

/* Breakpoint: Mobile First (default) */
/* On mobile, content takes up full width and side navigation starts collapsed. */
.side-nav {
    transform: translateX(100%);
    transition: transform 0.3s ease;
    width: min(350px, 90vw);
}

.side-nav.is-open {
    transform: translateX(0);
}

/* Breakpoint: Tablet and up (≥768px) */
/* On tablet and up, the navigation is always visible and on the right side of the screen, content has a max width and is centered in the rest of the screen. */
@media screen and (min-width: 768px) {
    body {
        display: grid;
        grid-template-columns: 1fr var(--side-nav-width);
        gap: var(--spacing-xl);
    }

    .main-content {
        place-self: center start;
        width: min(var(--content-max-width), 100%);
        margin-inline: auto;
    }

    .side-nav {
        transform: translateX(0);
        width: var(--side-nav-width);
    }

    .nav-toggle {
        display: none;
    }
}

/* Breakpoint: Desktop (≥1280px) */
/* On desktop, the content has a max width and is centered in the rest of the screen. The nav is no longer on the right side of the screen, it now floats in the center, towards the right of the content. */
@media screen and (min-width: 1280px) {
    body {
        max-width: calc(var(--content-max-width) + var(--side-nav-width) + var(--spacing-xl));
        margin-inline: auto;
    }

    .side-nav {
        right: calc((100% - (var(--content-max-width) + var(--side-nav-width) + var(--spacing-xl))) / 2);
    }
}